<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Survey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
    <!-- My CSS -->
    <link rel="stylesheet" href="/assets/css/style.css" type="text/css">

</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <div class="container">
                            <div class="row">
                                <form class="col s12">

                                    <div class="row">
                                        <div class="input-field col s12">
                                            <input placeholder="Name" id="first_name" type="text" class="validate">
                                            <label for="first_name">Please enter your name here</label>
                                        </div>
                                    </div>

                                    <label>1). You find it hard trusting others</label>
                                    <select class="browser-default validate" id="q1">
                                        <option value="" hidden disabled selected>Select an Option</option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>

                                    <label>2). You are loyal to your friends</label>
                                    <select class="browser-default validate" id="q2">
                                        <option value="" hidden disabled selected>Select an Option</option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>

                                    <label>3). You like to speak out your mind</label>
                                    <select class="browser-default validate" id="q3">
                                        <option value="" hidden disabled selected>Select an Option</option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
                                    
                                    <label>4). You like to keep secrets</label>
                                    <select class="browser-default validate" id="q4">
                                        <option value="" hidden disabled selected>Select an Option</option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>

                                    <label>5). You like to share your possessions with others</label>
                                    <select class="browser-default validate" id="q5">
                                        <option value="" hidden disabled selected>Select an Option</option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>

                                    <label>6). You prefer to stick to your own ideals rather than listen to others</label>
                                    <select class="browser-default validate" id="q6">
                                        <option value="" hidden disabled selected>Select an Option</option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>

                                    <label>7). You think of yourself as a very clean person</label>
                                    <select class="browser-default validate" id="q7">
                                        <option value="" hidden disabled selected>Select an Option</option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>

                                    <label>8). You care about your looks</label>
                                    <select class="browser-default validate" id="q8">
                                        <option value="" hidden disabled selected>Select an Option</option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
                                    
                                    <label>9). People say it is easy to get along with you</label>
                                    <select class="browser-default validate" id="q9">
                                        <option value="" hidden disabled selected>Select an Option</option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>

                                    <label>10). You rely on your own smarts than your own strength</label>
                                    <select class="browser-default validate" id="q10">
                                        <option value="" hidden disabled selected>Select an Option</option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>

                                </form>
                            </div>
                        </div>
                    </div>

                    <div class="card-action">

                        <!-- Modal Structure -->
                        <div class="modal">
                            <!-- close button -->
                            <a href="#!" class="right modal-close btn" id="close"><i class=" close material-icons right white-text">x</i></a>
                            <!-- These will be replaced by a name -->
                            <div class="modal-content">
                                <img id="charImg" width="500px" src="" alt="charcter image" class="responsive-img">
                                <h1 id="modalHead">
                                    <span id="inputname">Modal Header</span>, you are <span id="matchedName">Saber</span>
                                </h1>
                                <p id="bio"></p>
                            </div>

                        </div>
                        <button type='submit' class="btn right" id="eh">Submit</button>
                    </div>

                </div>
            </div>
        </div>
    </div>


    <footer class="footer">
        <div class="container">
            <p><a href="/api/characters">API Character List</a> | <a href="https://github.com/tintdang/characterQuiz">Github Link</a> </p>
        </div>
    </footer>
</body>

<!-- Compiled and minified JavaScript -->
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/js/materialize.min.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $('.modal').modal();
    });
    // prevents the inputbox from redirecting when pressing enter 
    $("#first_name").keypress(function(event){
        if ( event.which == 13 ) event.preventDefault();
    })

    $("#eh").on("click", function (event) {
        event.preventDefault();


        //Return if all inputs are not filled in ""
        function validate() {
            var isValid = true;
            $(".validate").each(function () {
                if ($(this).val() === "") {
                    isValid = false;
                }
            });
            return isValid;
        }

        if (validate()) {
            var userData = {
                name: $("#first_name").val().trim(),
                score: [
                    $("#q1").val(),
                    $("#q2").val(),
                    $("#q3").val(),
                    $("#q4").val(),
                    $("#q5").val(),
                    $("#q6").val(),
                    $("#q7").val(),
                    $("#q8").val(),
                    $("#q9").val(),
                    $("#q10").val()
                ]
            }

            $.post("/api/characters", userData)
                .then(function (data) {
                    console.log(data);
                    //replace these areas with the data we get back
                    $("#matchedName").text(data.name);
                    $("#inputname").text(data.userName);
                    $("#charImg").attr("src", data.photo);
                    $("#bio").text(data.bio)
                    $('.modal').modal('open');
                })
        } else{
            alert("Please fill out all the fields to get an response!")
        }
    })

</script>

</html>